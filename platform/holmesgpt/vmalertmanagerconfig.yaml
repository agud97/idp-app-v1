# VMAlertmanagerConfig - webhook в HolmesGPT
# Направляет firing alerts для автоматического расследования

apiVersion: operator.victoriametrics.com/v1beta1
kind: VMAlertmanagerConfig
metadata:
  name: holmesgpt-webhook
  namespace: holmesgpt
spec:
  route:
    receiver: holmesgpt
    matchers:
      - severity =~ "critical|warning"
    continue: true
    group_by:
      - alertname
      - namespace
    group_wait: 30s
    group_interval: 5m
    repeat_interval: 4h

  receivers:
    - name: holmesgpt
      webhook_configs:
        - url: "http://holmes-alertmanager-bridge.holmesgpt.svc:9095/webhook"
          send_resolved: false
